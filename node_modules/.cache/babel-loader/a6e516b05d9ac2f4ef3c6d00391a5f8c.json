{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport { parse, stringify } from 'qs';\nimport 'isomorphic-fetch';\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _construct(Parent, args, Class) {\n  if (_isNativeReflectConstruct()) {\n    _construct = Reflect.construct;\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) _setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}\n\nfunction _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}\n\nfunction _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n\n  _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !_isNativeFunction(Class)) return Class;\n\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n\n      _cache.set(Class, Wrapper);\n    }\n\n    function Wrapper() {\n      return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n    }\n\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return _setPrototypeOf(Wrapper, Class);\n  };\n\n  return _wrapNativeSuper(Class);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n} // 返回一个组合了所有插件的“插件”\n\n\nfunction compose(middlewares) {\n  if (!Array.isArray(middlewares)) throw new TypeError('Middlewares must be an array!');\n  var middlewaresLen = middlewares.length;\n\n  for (var i = 0; i < middlewaresLen; i++) {\n    if (typeof middlewares[i] !== 'function') {\n      throw new TypeError('Middleware must be componsed of function');\n    }\n  }\n\n  return function wrapMiddlewares(params, next) {\n    var index = -1;\n\n    function dispatch(i) {\n      if (i <= index) {\n        return Promise.reject(new Error('next() should not be called multiple times in one middleware!'));\n      }\n\n      index = i;\n      var fn = middlewares[i] || next;\n      if (!fn) return Promise.resolve();\n\n      try {\n        return Promise.resolve(fn(params, function () {\n          return dispatch(i + 1);\n        }));\n      } catch (err) {\n        return Promise.reject(err);\n      }\n    }\n\n    return dispatch(0);\n  };\n}\n\nvar Onion = /*#__PURE__*/function () {\n  function Onion(defaultMiddlewares) {\n    _classCallCheck(this, Onion);\n\n    if (!Array.isArray(defaultMiddlewares)) throw new TypeError('Default middlewares must be an array!');\n    this.defaultMiddlewares = _toConsumableArray(defaultMiddlewares);\n    this.middlewares = [];\n  }\n\n  _createClass(Onion, [{\n    key: \"use\",\n    value: // 内置内核中间件长度\n    function use(newMiddleware) {\n      var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n        global: false,\n        core: false,\n        defaultInstance: false\n      };\n      var core = false;\n      var global = false;\n      var defaultInstance = false;\n\n      if (typeof opts === 'number') {\n        if (process && process.env && process.env.NODE_ENV === 'development') {\n          console.warn('use() options should be object, number property would be deprecated in future，please update use() options to \"{ core: true }\".');\n        }\n\n        core = true;\n        global = false;\n      } else if (_typeof(opts) === 'object' && opts) {\n        global = opts.global || false;\n        core = opts.core || false;\n        defaultInstance = opts.defaultInstance || false;\n      } // 全局中间件\n\n\n      if (global) {\n        Onion.globalMiddlewares.splice(Onion.globalMiddlewares.length - Onion.defaultGlobalMiddlewaresLength, 0, newMiddleware);\n        return;\n      } // 内核中间件\n\n\n      if (core) {\n        Onion.coreMiddlewares.splice(Onion.coreMiddlewares.length - Onion.defaultCoreMiddlewaresLength, 0, newMiddleware);\n        return;\n      } // 默认实例中间件，供开发者使用\n\n\n      if (defaultInstance) {\n        this.defaultMiddlewares.push(newMiddleware);\n        return;\n      } // 实例中间件\n\n\n      this.middlewares.push(newMiddleware);\n    }\n  }, {\n    key: \"execute\",\n    value: function execute() {\n      var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      var fn = compose([].concat(_toConsumableArray(this.middlewares), _toConsumableArray(this.defaultMiddlewares), _toConsumableArray(Onion.globalMiddlewares), _toConsumableArray(Onion.coreMiddlewares)));\n      return fn(params);\n    }\n  }]);\n\n  return Onion;\n}();\n\nOnion.globalMiddlewares = [];\nOnion.defaultGlobalMiddlewaresLength = 0;\nOnion.coreMiddlewares = [];\nOnion.defaultCoreMiddlewaresLength = 0;\n\nvar MapCache = /*#__PURE__*/function () {\n  function MapCache(options) {\n    _classCallCheck(this, MapCache);\n\n    this.cache = new Map();\n    this.timer = {};\n    this.extendOptions(options);\n  }\n\n  _createClass(MapCache, [{\n    key: \"extendOptions\",\n    value: function extendOptions(options) {\n      this.maxCache = options.maxCache || 0;\n    }\n  }, {\n    key: \"get\",\n    value: function get(key) {\n      return this.cache.get(JSON.stringify(key));\n    }\n  }, {\n    key: \"set\",\n    value: function set(key, value) {\n      var _this = this;\n\n      var ttl = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 60000; // 如果超过最大缓存数, 删除头部的第一个缓存.\n\n      if (this.maxCache > 0 && this.cache.size >= this.maxCache) {\n        var deleteKey = _toConsumableArray(this.cache.keys())[0];\n\n        this.cache.delete(deleteKey);\n\n        if (this.timer[deleteKey]) {\n          clearTimeout(this.timer[deleteKey]);\n        }\n      }\n\n      var cacheKey = JSON.stringify(key);\n      this.cache.set(cacheKey, value);\n\n      if (ttl > 0) {\n        this.timer[cacheKey] = setTimeout(function () {\n          _this.cache.delete(cacheKey);\n\n          delete _this.timer[cacheKey];\n        }, ttl);\n      }\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete(key) {\n      var cacheKey = JSON.stringify(key);\n      delete this.timer[cacheKey];\n      return this.cache.delete(cacheKey);\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      this.timer = {};\n      return this.cache.clear();\n    }\n  }]);\n\n  return MapCache;\n}();\n/**\n * 请求异常\n */\n\n\nvar RequestError = /*#__PURE__*/function (_Error) {\n  _inherits(RequestError, _Error);\n\n  var _super = _createSuper(RequestError);\n\n  function RequestError(text, request) {\n    var _this2;\n\n    var type = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'RequestError';\n\n    _classCallCheck(this, RequestError);\n\n    _this2 = _super.call(this, text);\n    _this2.name = 'RequestError';\n    _this2.request = request;\n    _this2.type = type;\n    return _this2;\n  }\n\n  return RequestError;\n}( /*#__PURE__*/_wrapNativeSuper(Error));\n/**\n * 响应异常\n */\n\n\nvar ResponseError = /*#__PURE__*/function (_Error2) {\n  _inherits(ResponseError, _Error2);\n\n  var _super2 = _createSuper(ResponseError);\n\n  function ResponseError(response, text, data, request) {\n    var _this3;\n\n    var type = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 'ResponseError';\n\n    _classCallCheck(this, ResponseError);\n\n    _this3 = _super2.call(this, text || response.statusText);\n    _this3.name = 'ResponseError';\n    _this3.data = data;\n    _this3.response = response;\n    _this3.request = request;\n    _this3.type = type;\n    return _this3;\n  }\n\n  return ResponseError;\n}( /*#__PURE__*/_wrapNativeSuper(Error));\n/**\n * http://gitlab.alipay-inc.com/KBSJ/gxt/blob/release_gxt_S8928905_20180531/src/util/request.js#L63\n * 支持gbk\n */\n\n\nfunction readerGBK(file) {\n  return new Promise(function (resolve, reject) {\n    var reader = new FileReader();\n\n    reader.onload = function () {\n      resolve(reader.result);\n    };\n\n    reader.onerror = reject;\n    reader.readAsText(file, 'GBK'); // setup GBK decoding\n  });\n}\n/**\n * 安全的JSON.parse\n */\n\n\nfunction safeJsonParse(data) {\n  var throwErrIfParseFail = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var response = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n  var request = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\n  try {\n    return JSON.parse(data);\n  } catch (e) {\n    if (throwErrIfParseFail) {\n      throw new ResponseError(response, 'JSON.parse fail', data, request, 'ParseError');\n    }\n  } // eslint-disable-line no-empty\n\n\n  return data;\n}\n\nfunction timeout2Throw(msec, timeoutMessage, request) {\n  return new Promise(function (_, reject) {\n    setTimeout(function () {\n      reject(new RequestError(timeoutMessage || \"timeout of \".concat(msec, \"ms exceeded\"), request, 'Timeout'));\n    }, msec);\n  });\n} // If request options contain 'cancelToken', reject request when token has been canceled\n\n\nfunction cancel2Throw(opt) {\n  return new Promise(function (_, reject) {\n    if (opt.cancelToken) {\n      opt.cancelToken.promise.then(function (cancel) {\n        reject(cancel);\n      });\n    }\n  });\n}\n\nvar toString = Object.prototype.toString; // Check env is browser or node\n\nfunction getEnv() {\n  var env; // Only Node.JS has a process variable that is of [[Class]] process\n\n  if (typeof process !== 'undefined' && toString.call(process) === '[object process]') {\n    // For node use HTTP adapter\n    env = 'NODE';\n  }\n\n  if (typeof XMLHttpRequest !== 'undefined') {\n    env = 'BROWSER';\n  }\n\n  return env;\n}\n\nfunction isArray(val) {\n  return _typeof(val) === 'object' && Object.prototype.toString.call(val) === '[object Array]';\n}\n\nfunction isURLSearchParams(val) {\n  return typeof URLSearchParams !== 'undefined' && val instanceof URLSearchParams;\n}\n\nfunction isDate(val) {\n  return _typeof(val) === 'object' && Object.prototype.toString.call(val) === '[object Date]';\n}\n\nfunction isObject(val) {\n  return val !== null && _typeof(val) === 'object';\n}\n\nfunction forEach2ObjArr(target, callback) {\n  if (!target) return;\n\n  if (_typeof(target) !== 'object') {\n    target = [target];\n  }\n\n  if (isArray(target)) {\n    for (var i = 0; i < target.length; i++) {\n      callback.call(null, target[i], i, target);\n    }\n  } else {\n    for (var key in target) {\n      if (Object.prototype.hasOwnProperty.call(target, key)) {\n        callback.call(null, target[key], key, target);\n      }\n    }\n  }\n}\n\nfunction getParamObject(val) {\n  if (isURLSearchParams(val)) {\n    return parse(val.toString(), {\n      strictNullHandling: true\n    });\n  }\n\n  if (typeof val === 'string') {\n    return [val];\n  }\n\n  return val;\n}\n\nfunction reqStringify(val) {\n  return stringify(val, {\n    arrayFormat: 'repeat',\n    strictNullHandling: true\n  });\n}\n\nfunction mergeRequestOptions(options, options2Merge) {\n  return _objectSpread2(_objectSpread2(_objectSpread2({}, options), options2Merge), {}, {\n    headers: _objectSpread2(_objectSpread2({}, options.headers), options2Merge.headers),\n    params: _objectSpread2(_objectSpread2({}, getParamObject(options.params)), getParamObject(options2Merge.params)),\n    method: (options2Merge.method || options.method || 'get').toLowerCase()\n  });\n} // 前后缀拦截\n\n\nvar addfix = function addfix(url) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var prefix = options.prefix,\n      suffix = options.suffix;\n\n  if (prefix) {\n    url = \"\".concat(prefix).concat(url);\n  }\n\n  if (suffix) {\n    url = \"\".concat(url).concat(suffix);\n  }\n\n  return {\n    url: url,\n    options: options\n  };\n};\n\nvar warnedCoreType = false; // 默认缓存判断，开放缓存判断给非 get 请求使用\n\nfunction __defaultValidateCache(url, options) {\n  var _options$method = options.method,\n      method = _options$method === void 0 ? 'get' : _options$method;\n  return method.toLowerCase() === 'get';\n}\n\nfunction fetchMiddleware(ctx, next) {\n  if (!ctx) return next();\n  var _ctx$req = ctx.req;\n  _ctx$req = _ctx$req === void 0 ? {} : _ctx$req;\n  var _ctx$req$options = _ctx$req.options,\n      options = _ctx$req$options === void 0 ? {} : _ctx$req$options,\n      _ctx$req$url = _ctx$req.url,\n      url = _ctx$req$url === void 0 ? '' : _ctx$req$url,\n      cache = ctx.cache,\n      responseInterceptors = ctx.responseInterceptors;\n\n  var _options$timeout = options.timeout,\n      timeout = _options$timeout === void 0 ? 0 : _options$timeout,\n      timeoutMessage = options.timeoutMessage,\n      _options$__umiRequest = options.__umiRequestCoreType__,\n      __umiRequestCoreType__ = _options$__umiRequest === void 0 ? 'normal' : _options$__umiRequest,\n      _options$useCache = options.useCache,\n      useCache = _options$useCache === void 0 ? false : _options$useCache,\n      _options$method2 = options.method,\n      method = _options$method2 === void 0 ? 'get' : _options$method2,\n      params = options.params,\n      ttl = options.ttl,\n      _options$validateCach = options.validateCache,\n      validateCache = _options$validateCach === void 0 ? __defaultValidateCache : _options$validateCach;\n\n  if (__umiRequestCoreType__ !== 'normal') {\n    if (process && process.env && process.env.NODE_ENV === 'development' && warnedCoreType === false) {\n      warnedCoreType = true;\n      console.warn('__umiRequestCoreType__ is a internal property that use in umi-request, change its value would affect the behavior of request! It only use when you want to extend or use request core.');\n    }\n\n    return next();\n  }\n\n  var adapter = fetch;\n\n  if (!adapter) {\n    throw new Error('Global fetch not exist!');\n  } // 从缓存池检查是否有缓存数据\n\n\n  var isBrowser = getEnv() === 'BROWSER';\n  var needCache = validateCache(url, options) && useCache && isBrowser;\n\n  if (needCache) {\n    var responseCache = cache.get({\n      url: url,\n      params: params,\n      method: method\n    });\n\n    if (responseCache) {\n      responseCache = responseCache.clone();\n      responseCache.useCache = true;\n      ctx.res = responseCache;\n      return next();\n    }\n  }\n\n  var response; // 超时处理、取消请求处理\n\n  if (timeout > 0) {\n    response = Promise.race([cancel2Throw(options), adapter(url, options), timeout2Throw(timeout, timeoutMessage, ctx.req)]);\n  } else {\n    response = Promise.race([cancel2Throw(options), adapter(url, options)]);\n  } // 兼容老版本 response.interceptor\n\n\n  responseInterceptors.forEach(function (handler) {\n    response = response.then(function (res) {\n      // Fix multiple clones not working, issue: https://github.com/github/fetch/issues/504\n      var clonedRes = typeof res.clone === 'function' ? res.clone() : res;\n      return handler(clonedRes, options);\n    });\n  });\n  return response.then(function (res) {\n    // 是否存入缓存池\n    if (needCache) {\n      if (res.status === 200) {\n        var copy = res.clone();\n        copy.useCache = true;\n        cache.set({\n          url: url,\n          params: params,\n          method: method\n        }, copy, ttl);\n      }\n    }\n\n    ctx.res = res;\n    return next();\n  });\n}\n\nfunction parseResponseMiddleware(ctx, next) {\n  var copy;\n  return next().then(function () {\n    if (!ctx) return;\n    var _ctx$res = ctx.res,\n        res = _ctx$res === void 0 ? {} : _ctx$res,\n        _ctx$req = ctx.req,\n        req = _ctx$req === void 0 ? {} : _ctx$req;\n\n    var _ref = req || {},\n        _ref$options = _ref.options;\n\n    _ref$options = _ref$options === void 0 ? {} : _ref$options;\n    var _ref$options$response = _ref$options.responseType,\n        responseType = _ref$options$response === void 0 ? 'json' : _ref$options$response,\n        _ref$options$charset = _ref$options.charset,\n        charset = _ref$options$charset === void 0 ? 'utf8' : _ref$options$charset,\n        _ref$options$getRespo = _ref$options.getResponse,\n        _ref$options$throwErr = _ref$options.throwErrIfParseFail,\n        throwErrIfParseFail = _ref$options$throwErr === void 0 ? false : _ref$options$throwErr,\n        _ref$options$parseRes = _ref$options.parseResponse,\n        parseResponse = _ref$options$parseRes === void 0 ? true : _ref$options$parseRes;\n\n    if (!parseResponse) {\n      return;\n    }\n\n    if (!res || !res.clone) {\n      return;\n    } // 只在浏览器环境对 response 做克隆， node 环境如果对 response 克隆会有问题：https://github.com/bitinn/node-fetch/issues/553\n\n\n    copy = getEnv() === 'BROWSER' ? res.clone() : res;\n    copy.useCache = res.useCache || false; // 解析数据\n\n    if (charset === 'gbk') {\n      try {\n        return res.blob().then(readerGBK).then(function (d) {\n          return safeJsonParse(d, false, copy, req);\n        });\n      } catch (e) {\n        throw new ResponseError(copy, e.message, null, req, 'ParseError');\n      }\n    } else if (responseType === 'json') {\n      return res.text().then(function (d) {\n        return safeJsonParse(d, throwErrIfParseFail, copy, req);\n      });\n    }\n\n    try {\n      // 其他如text, blob, arrayBuffer, formData\n      return res[responseType]();\n    } catch (e) {\n      throw new ResponseError(copy, 'responseType not support', null, req, 'ParseError');\n    }\n  }).then(function (body) {\n    if (!ctx) return;\n    var _ctx$res2 = ctx.res,\n        _ctx$req2 = ctx.req,\n        req = _ctx$req2 === void 0 ? {} : _ctx$req2;\n\n    var _ref2 = req || {},\n        _ref2$options = _ref2.options;\n\n    _ref2$options = _ref2$options === void 0 ? {} : _ref2$options;\n    var _ref2$options$getResp = _ref2$options.getResponse,\n        getResponse = _ref2$options$getResp === void 0 ? false : _ref2$options$getResp;\n\n    if (!copy) {\n      return;\n    }\n\n    if (copy.status >= 200 && copy.status < 300) {\n      // 提供源response, 以便自定义处理\n      if (getResponse) {\n        ctx.res = {\n          data: body,\n          response: copy\n        };\n        return;\n      }\n\n      ctx.res = body;\n      return;\n    }\n\n    throw new ResponseError(copy, 'http error', body, req, 'HttpError');\n  }).catch(function (e) {\n    if (e instanceof RequestError || e instanceof ResponseError) {\n      throw e;\n    } // 对未知错误进行处理\n\n\n    var req = ctx.req,\n        res = ctx.res;\n    e.request = e.request || req;\n    e.response = e.response || res;\n    e.type = e.type || e.name;\n    e.data = e.data || undefined;\n    throw e;\n  });\n}\n\nfunction simplePostMiddleware(ctx, next) {\n  if (!ctx) return next();\n  var _ctx$req = ctx.req;\n  _ctx$req = _ctx$req === void 0 ? {} : _ctx$req;\n  var _ctx$req$options = _ctx$req.options,\n      options = _ctx$req$options === void 0 ? {} : _ctx$req$options;\n  var _options$method = options.method,\n      method = _options$method === void 0 ? 'get' : _options$method;\n\n  if (['post', 'put', 'patch', 'delete'].indexOf(method.toLowerCase()) === -1) {\n    return next();\n  }\n\n  var _options$requestType = options.requestType,\n      requestType = _options$requestType === void 0 ? 'json' : _options$requestType,\n      data = options.data; // 数据使用类axios的新字段data, 避免引用后影响旧代码, 如将body stringify多次\n\n  if (data) {\n    var dataType = Object.prototype.toString.call(data);\n\n    if (dataType === '[object Object]' || dataType === '[object Array]') {\n      if (requestType === 'json') {\n        options.headers = _objectSpread2({\n          Accept: 'application/json',\n          'Content-Type': 'application/json;charset=UTF-8'\n        }, options.headers);\n        options.body = JSON.stringify(data);\n      } else if (requestType === 'form') {\n        options.headers = _objectSpread2({\n          Accept: 'application/json',\n          'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8'\n        }, options.headers);\n        options.body = reqStringify(data);\n      }\n    } else {\n      // 其他 requestType 自定义header\n      options.headers = _objectSpread2({\n        Accept: 'application/json'\n      }, options.headers);\n      options.body = data;\n    }\n  }\n\n  ctx.req.options = options;\n  return next();\n}\n\nfunction paramsSerialize(params, paramsSerializer) {\n  var serializedParams;\n  var jsonStringifiedParams; // 支持参数自动拼装，其他 method 也可用，不冲突\n\n  if (params) {\n    if (paramsSerializer) {\n      serializedParams = paramsSerializer(params);\n    } else if (isURLSearchParams(params)) {\n      serializedParams = params.toString();\n    } else {\n      if (isArray(params)) {\n        jsonStringifiedParams = [];\n        forEach2ObjArr(params, function (item) {\n          if (item === null || typeof item === 'undefined') {\n            jsonStringifiedParams.push(item);\n          } else {\n            jsonStringifiedParams.push(isObject(item) ? JSON.stringify(item) : item);\n          }\n        }); // a: [1,2,3] => a=1&a=2&a=3\n\n        serializedParams = reqStringify(jsonStringifiedParams);\n      } else {\n        jsonStringifiedParams = {};\n        forEach2ObjArr(params, function (value, key) {\n          var jsonStringifiedValue = value;\n\n          if (value === null || typeof value === 'undefined') {\n            jsonStringifiedParams[key] = value;\n          } else if (isDate(value)) {\n            jsonStringifiedValue = value.toISOString();\n          } else if (isArray(value)) {\n            jsonStringifiedValue = value;\n          } else if (isObject(value)) {\n            jsonStringifiedValue = JSON.stringify(value);\n          }\n\n          jsonStringifiedParams[key] = jsonStringifiedValue;\n        });\n        var tmp = reqStringify(jsonStringifiedParams);\n        serializedParams = tmp;\n      }\n    }\n  }\n\n  return serializedParams;\n} // 对请求参数做处理，实现 query 简化、 post 简化\n\n\nfunction simpleGetMiddleware(ctx, next) {\n  if (!ctx) return next();\n  var _ctx$req = ctx.req;\n  _ctx$req = _ctx$req === void 0 ? {} : _ctx$req;\n  var _ctx$req$options = _ctx$req.options,\n      options = _ctx$req$options === void 0 ? {} : _ctx$req$options;\n  var paramsSerializer = options.paramsSerializer,\n      params = options.params;\n  var _ctx$req2 = ctx.req;\n  _ctx$req2 = _ctx$req2 === void 0 ? {} : _ctx$req2;\n  var _ctx$req2$url = _ctx$req2.url,\n      url = _ctx$req2$url === void 0 ? '' : _ctx$req2$url; // 将 method 改为大写\n\n  options.method = options.method ? options.method.toUpperCase() : 'GET'; // 设置 credentials 默认值为 same-origin，确保当开发者没有设置时，各浏览器对请求是否发送 cookies 保持一致的行为\n  // - omit: 从不发送cookies.\n  // - same-origin: 只有当URL与响应脚本同源才发送 cookies、 HTTP Basic authentication 等验证信息.(浏览器默认值,在旧版本浏览器，例如safari 11依旧是omit，safari 12已更改)\n  // - include: 不论是不是跨域的请求,总是发送请求资源域在本地的 cookies、 HTTP Basic authentication 等验证信息.\n\n  options.credentials = options.credentials || 'same-origin'; // 支持类似axios 参数自动拼装, 其他method也可用, 不冲突.\n\n  var serializedParams = paramsSerialize(params, paramsSerializer);\n  ctx.req.originUrl = url;\n\n  if (serializedParams) {\n    var urlSign = url.indexOf('?') !== -1 ? '&' : '?';\n    ctx.req.url = \"\".concat(url).concat(urlSign).concat(serializedParams);\n  }\n\n  ctx.req.options = options;\n  return next();\n}\n\nvar globalMiddlewares = [simplePostMiddleware, simpleGetMiddleware, parseResponseMiddleware];\nvar coreMiddlewares = [fetchMiddleware];\nOnion.globalMiddlewares = globalMiddlewares;\nOnion.defaultGlobalMiddlewaresLength = globalMiddlewares.length;\nOnion.coreMiddlewares = coreMiddlewares;\nOnion.defaultCoreMiddlewaresLength = coreMiddlewares.length;\n\nvar Core = /*#__PURE__*/function () {\n  function Core(initOptions) {\n    _classCallCheck(this, Core);\n\n    this.onion = new Onion([]);\n    this.fetchIndex = 0; // 【即将废弃】请求中间件位置\n\n    this.mapCache = new MapCache(initOptions);\n    this.initOptions = initOptions;\n    this.instanceRequestInterceptors = [];\n    this.instanceResponseInterceptors = [];\n  } // 旧版拦截器为共享\n\n\n  _createClass(Core, [{\n    key: \"use\",\n    value: function use(newMiddleware) {\n      var opt = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n        global: false,\n        core: false\n      };\n      this.onion.use(newMiddleware, opt);\n      return this;\n    }\n  }, {\n    key: \"extendOptions\",\n    value: function extendOptions(options) {\n      this.initOptions = mergeRequestOptions(this.initOptions, options);\n      this.mapCache.extendOptions(options);\n    } // 执行请求前拦截器\n\n  }, {\n    key: \"dealRequestInterceptors\",\n    value: function dealRequestInterceptors(ctx) {\n      var reducer = function reducer(p1, p2) {\n        return p1.then(function () {\n          var ret = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n          ctx.req.url = ret.url || ctx.req.url;\n          ctx.req.options = ret.options || ctx.req.options;\n          return p2(ctx.req.url, ctx.req.options);\n        });\n      };\n\n      var allInterceptors = [].concat(_toConsumableArray(Core.requestInterceptors), _toConsumableArray(this.instanceRequestInterceptors));\n      return allInterceptors.reduce(reducer, Promise.resolve()).then(function () {\n        var ret = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        ctx.req.url = ret.url || ctx.req.url;\n        ctx.req.options = ret.options || ctx.req.options;\n        return Promise.resolve();\n      });\n    }\n  }, {\n    key: \"request\",\n    value: function request(url, options) {\n      var _this = this;\n\n      var onion = this.onion;\n      var obj = {\n        req: {\n          url: url,\n          options: _objectSpread2(_objectSpread2({}, options), {}, {\n            url: url\n          })\n        },\n        res: null,\n        cache: this.mapCache,\n        responseInterceptors: [].concat(_toConsumableArray(Core.responseInterceptors), _toConsumableArray(this.instanceResponseInterceptors))\n      };\n\n      if (typeof url !== 'string') {\n        throw new Error('url MUST be a string');\n      }\n\n      return new Promise(function (resolve, reject) {\n        _this.dealRequestInterceptors(obj).then(function () {\n          return onion.execute(obj);\n        }).then(function () {\n          resolve(obj.res);\n        }).catch(function (error) {\n          var errorHandler = obj.req.options.errorHandler;\n\n          if (errorHandler) {\n            try {\n              var data = errorHandler(error);\n              resolve(data);\n            } catch (e) {\n              reject(e);\n            }\n          } else {\n            reject(error);\n          }\n        });\n      });\n    }\n  }], [{\n    key: \"requestUse\",\n    value: // 请求拦截器 默认 { global: true } 兼容旧版本拦截器\n    function requestUse(handler) {\n      var opt = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n        global: true\n      };\n      if (typeof handler !== 'function') throw new TypeError('Interceptor must be function!');\n\n      if (opt.global) {\n        Core.requestInterceptors.push(handler);\n      } else {\n        this.instanceRequestInterceptors.push(handler);\n      }\n    } // 响应拦截器 默认 { global: true } 兼容旧版本拦截器\n\n  }, {\n    key: \"responseUse\",\n    value: function responseUse(handler) {\n      var opt = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n        global: true\n      };\n      if (typeof handler !== 'function') throw new TypeError('Interceptor must be function!');\n\n      if (opt.global) {\n        Core.responseInterceptors.push(handler);\n      } else {\n        this.instanceResponseInterceptors.push(handler);\n      }\n    }\n  }]);\n\n  return Core;\n}();\n\nCore.requestInterceptors = [addfix];\nCore.responseInterceptors = [];\n/**\n * 当执行 “取消请求” 操作时会抛出 Cancel 对象作为一场\n * @class\n * @param {string=} message The message.\n */\n\nfunction Cancel(message) {\n  this.message = message;\n}\n\nCancel.prototype.toString = function toString() {\n  return this.message ? \"Cancel: \".concat(this.message) : 'Cancel';\n};\n\nCancel.prototype.__CANCEL__ = true;\n/**\n * 通过 CancelToken 来取消请求操作\n *\n * @class\n * @param {Function} executor The executor function.\n */\n\nfunction CancelToken(executor) {\n  if (typeof executor !== 'function') {\n    throw new TypeError('executor must be a function.');\n  }\n\n  var resolvePromise;\n  this.promise = new Promise(function promiseExecutor(resolve) {\n    resolvePromise = resolve;\n  });\n  var token = this;\n  executor(function cancel(message) {\n    if (token.reason) {\n      // 取消操作已被调用过\n      return;\n    }\n\n    token.reason = new Cancel(message);\n    resolvePromise(token.reason);\n  });\n}\n/**\n * 如果请求已经取消，抛出 Cancel 异常\n */\n\n\nCancelToken.prototype.throwIfRequested = function throwIfRequested() {\n  if (this.reason) {\n    throw this.reason;\n  }\n};\n/**\n * 通过 source 来返回 CancelToken 实例和取消 CancelToken 的函数\n */\n\n\nCancelToken.source = function source() {\n  var cancel;\n  var token = new CancelToken(function executor(c) {\n    cancel = c;\n  });\n  return {\n    token: token,\n    cancel: cancel\n  };\n};\n\nfunction isCancel(value) {\n  return !!(value && value.__CANCEL__);\n}\n\nvar request = function request() {\n  var initOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var coreInstance = new Core(initOptions);\n\n  var umiInstance = function umiInstance(url) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var mergeOptions = mergeRequestOptions(coreInstance.initOptions, options);\n    return coreInstance.request(url, mergeOptions);\n  }; // 中间件\n\n\n  umiInstance.use = coreInstance.use.bind(coreInstance);\n  umiInstance.fetchIndex = coreInstance.fetchIndex; // 拦截器\n\n  umiInstance.interceptors = {\n    request: {\n      use: Core.requestUse.bind(coreInstance)\n    },\n    response: {\n      use: Core.responseUse.bind(coreInstance)\n    }\n  }; // 请求语法糖： reguest.get request.post ……\n\n  var METHODS = ['get', 'post', 'delete', 'put', 'patch', 'head', 'options', 'rpc'];\n  METHODS.forEach(function (method) {\n    umiInstance[method] = function (url, options) {\n      return umiInstance(url, _objectSpread2(_objectSpread2({}, options), {}, {\n        method: method\n      }));\n    };\n  });\n  umiInstance.Cancel = Cancel;\n  umiInstance.CancelToken = CancelToken;\n  umiInstance.isCancel = isCancel;\n  umiInstance.extendOptions = coreInstance.extendOptions.bind(coreInstance); // 暴露各个实例的中间件，供开发者自由组合\n\n  umiInstance.middlewares = {\n    instance: coreInstance.onion.middlewares,\n    defaultInstance: coreInstance.onion.defaultMiddlewares,\n    global: Onion.globalMiddlewares,\n    core: Onion.coreMiddlewares\n  };\n  return umiInstance;\n};\n/**\n * extend 方法参考了ky, 让用户可以定制配置.\n * initOpions 初始化参数\n * @param {number} maxCache 最大缓存数\n * @param {string} prefix url前缀\n * @param {function} errorHandler 统一错误处理方法\n * @param {object} headers 统一的headers\n */\n\n\nvar extend = function extend(initOptions) {\n  return request(initOptions);\n};\n/**\n * 暴露 fetch 中间件，保障依旧可以使用\n */\n\n\nvar fetch$1 = request({\n  parseResponse: false\n});\nvar request$1 = request({});\nexport default request$1;\nexport { Onion, RequestError, ResponseError, extend, fetch$1 as fetch };","map":{"version":3,"sources":["D:/Program Files/web/prj/sendRobot/node_modules/umi-request/dist/index.esm.js"],"names":["parse","stringify","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread2","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_typeof","obj","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","props","descriptor","configurable","writable","_createClass","protoProps","staticProps","value","_inherits","subClass","superClass","create","_setPrototypeOf","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","p","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","Boolean","valueOf","call","e","_construct","Parent","args","Class","a","Function","bind","_isNativeFunction","fn","toString","indexOf","_wrapNativeSuper","_cache","Map","undefined","has","get","set","Wrapper","_assertThisInitialized","self","ReferenceError","_possibleConstructorReturn","_createSuper","Derived","hasNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","Array","isArray","_arrayLikeToArray","iter","from","minLen","n","slice","name","test","len","arr2","compose","middlewares","middlewaresLen","wrapMiddlewares","params","next","index","dispatch","Promise","reject","Error","resolve","err","Onion","defaultMiddlewares","use","newMiddleware","opts","global","core","defaultInstance","process","env","NODE_ENV","console","warn","globalMiddlewares","splice","defaultGlobalMiddlewaresLength","coreMiddlewares","defaultCoreMiddlewaresLength","execute","concat","MapCache","options","cache","timer","extendOptions","maxCache","JSON","_this","ttl","size","deleteKey","delete","clearTimeout","cacheKey","setTimeout","_delete","clear","RequestError","_Error","_super","text","request","_this2","type","ResponseError","_Error2","_super2","response","data","_this3","statusText","readerGBK","file","reader","FileReader","onload","onerror","readAsText","safeJsonParse","throwErrIfParseFail","timeout2Throw","msec","timeoutMessage","_","cancel2Throw","opt","cancelToken","promise","then","cancel","getEnv","XMLHttpRequest","val","isURLSearchParams","URLSearchParams","isDate","isObject","forEach2ObjArr","callback","hasOwnProperty","getParamObject","strictNullHandling","reqStringify","arrayFormat","mergeRequestOptions","options2Merge","headers","method","toLowerCase","addfix","url","prefix","suffix","warnedCoreType","__defaultValidateCache","_options$method","fetchMiddleware","ctx","_ctx$req","req","_ctx$req$options","_ctx$req$url","responseInterceptors","_options$timeout","timeout","_options$__umiRequest","__umiRequestCoreType__","_options$useCache","useCache","_options$method2","_options$validateCach","validateCache","adapter","fetch","isBrowser","needCache","responseCache","clone","res","race","handler","clonedRes","status","copy","parseResponseMiddleware","_ctx$res","_ref","_ref$options","_ref$options$response","responseType","_ref$options$charset","charset","_ref$options$getRespo","getResponse","_ref$options$throwErr","_ref$options$parseRes","parseResponse","blob","d","message","body","_ctx$res2","_ctx$req2","_ref2","_ref2$options","_ref2$options$getResp","catch","simplePostMiddleware","_options$requestType","requestType","dataType","Accept","paramsSerialize","paramsSerializer","serializedParams","jsonStringifiedParams","item","jsonStringifiedValue","toISOString","tmp","simpleGetMiddleware","_ctx$req2$url","toUpperCase","credentials","originUrl","urlSign","Core","initOptions","onion","fetchIndex","mapCache","instanceRequestInterceptors","instanceResponseInterceptors","dealRequestInterceptors","reducer","p1","p2","ret","allInterceptors","requestInterceptors","reduce","error","errorHandler","requestUse","responseUse","Cancel","__CANCEL__","CancelToken","executor","resolvePromise","promiseExecutor","token","reason","throwIfRequested","c","isCancel","coreInstance","umiInstance","mergeOptions","interceptors","METHODS","extend","fetch$1","request$1"],"mappings":"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","sourcesContent":["import { parse, stringify } from 'qs';\nimport 'isomorphic-fetch';\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _construct(Parent, args, Class) {\n  if (_isNativeReflectConstruct()) {\n    _construct = Reflect.construct;\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) _setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}\n\nfunction _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}\n\nfunction _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n\n  _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !_isNativeFunction(Class)) return Class;\n\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n\n      _cache.set(Class, Wrapper);\n    }\n\n    function Wrapper() {\n      return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n    }\n\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return _setPrototypeOf(Wrapper, Class);\n  };\n\n  return _wrapNativeSuper(Class);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\n// 返回一个组合了所有插件的“插件”\nfunction compose(middlewares) {\n  if (!Array.isArray(middlewares)) throw new TypeError('Middlewares must be an array!');\n  var middlewaresLen = middlewares.length;\n\n  for (var i = 0; i < middlewaresLen; i++) {\n    if (typeof middlewares[i] !== 'function') {\n      throw new TypeError('Middleware must be componsed of function');\n    }\n  }\n\n  return function wrapMiddlewares(params, next) {\n    var index = -1;\n\n    function dispatch(i) {\n      if (i <= index) {\n        return Promise.reject(new Error('next() should not be called multiple times in one middleware!'));\n      }\n\n      index = i;\n      var fn = middlewares[i] || next;\n      if (!fn) return Promise.resolve();\n\n      try {\n        return Promise.resolve(fn(params, function () {\n          return dispatch(i + 1);\n        }));\n      } catch (err) {\n        return Promise.reject(err);\n      }\n    }\n\n    return dispatch(0);\n  };\n}\n\nvar Onion = /*#__PURE__*/function () {\n  function Onion(defaultMiddlewares) {\n    _classCallCheck(this, Onion);\n\n    if (!Array.isArray(defaultMiddlewares)) throw new TypeError('Default middlewares must be an array!');\n    this.defaultMiddlewares = _toConsumableArray(defaultMiddlewares);\n    this.middlewares = [];\n  }\n\n  _createClass(Onion, [{\n    key: \"use\",\n    value: // 内置内核中间件长度\n    function use(newMiddleware) {\n      var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n        global: false,\n        core: false,\n        defaultInstance: false\n      };\n      var core = false;\n      var global = false;\n      var defaultInstance = false;\n\n      if (typeof opts === 'number') {\n        if (process && process.env && process.env.NODE_ENV === 'development') {\n          console.warn('use() options should be object, number property would be deprecated in future，please update use() options to \"{ core: true }\".');\n        }\n\n        core = true;\n        global = false;\n      } else if (_typeof(opts) === 'object' && opts) {\n        global = opts.global || false;\n        core = opts.core || false;\n        defaultInstance = opts.defaultInstance || false;\n      } // 全局中间件\n\n\n      if (global) {\n        Onion.globalMiddlewares.splice(Onion.globalMiddlewares.length - Onion.defaultGlobalMiddlewaresLength, 0, newMiddleware);\n        return;\n      } // 内核中间件\n\n\n      if (core) {\n        Onion.coreMiddlewares.splice(Onion.coreMiddlewares.length - Onion.defaultCoreMiddlewaresLength, 0, newMiddleware);\n        return;\n      } // 默认实例中间件，供开发者使用\n\n\n      if (defaultInstance) {\n        this.defaultMiddlewares.push(newMiddleware);\n        return;\n      } // 实例中间件\n\n\n      this.middlewares.push(newMiddleware);\n    }\n  }, {\n    key: \"execute\",\n    value: function execute() {\n      var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      var fn = compose([].concat(_toConsumableArray(this.middlewares), _toConsumableArray(this.defaultMiddlewares), _toConsumableArray(Onion.globalMiddlewares), _toConsumableArray(Onion.coreMiddlewares)));\n      return fn(params);\n    }\n  }]);\n\n  return Onion;\n}();\n\nOnion.globalMiddlewares = [];\nOnion.defaultGlobalMiddlewaresLength = 0;\nOnion.coreMiddlewares = [];\nOnion.defaultCoreMiddlewaresLength = 0;\n\nvar MapCache = /*#__PURE__*/function () {\n  function MapCache(options) {\n    _classCallCheck(this, MapCache);\n\n    this.cache = new Map();\n    this.timer = {};\n    this.extendOptions(options);\n  }\n\n  _createClass(MapCache, [{\n    key: \"extendOptions\",\n    value: function extendOptions(options) {\n      this.maxCache = options.maxCache || 0;\n    }\n  }, {\n    key: \"get\",\n    value: function get(key) {\n      return this.cache.get(JSON.stringify(key));\n    }\n  }, {\n    key: \"set\",\n    value: function set(key, value) {\n      var _this = this;\n\n      var ttl = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 60000;\n\n      // 如果超过最大缓存数, 删除头部的第一个缓存.\n      if (this.maxCache > 0 && this.cache.size >= this.maxCache) {\n        var deleteKey = _toConsumableArray(this.cache.keys())[0];\n\n        this.cache.delete(deleteKey);\n\n        if (this.timer[deleteKey]) {\n          clearTimeout(this.timer[deleteKey]);\n        }\n      }\n\n      var cacheKey = JSON.stringify(key);\n      this.cache.set(cacheKey, value);\n\n      if (ttl > 0) {\n        this.timer[cacheKey] = setTimeout(function () {\n          _this.cache.delete(cacheKey);\n\n          delete _this.timer[cacheKey];\n        }, ttl);\n      }\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete(key) {\n      var cacheKey = JSON.stringify(key);\n      delete this.timer[cacheKey];\n      return this.cache.delete(cacheKey);\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      this.timer = {};\n      return this.cache.clear();\n    }\n  }]);\n\n  return MapCache;\n}();\n/**\n * 请求异常\n */\n\nvar RequestError = /*#__PURE__*/function (_Error) {\n  _inherits(RequestError, _Error);\n\n  var _super = _createSuper(RequestError);\n\n  function RequestError(text, request) {\n    var _this2;\n\n    var type = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'RequestError';\n\n    _classCallCheck(this, RequestError);\n\n    _this2 = _super.call(this, text);\n    _this2.name = 'RequestError';\n    _this2.request = request;\n    _this2.type = type;\n    return _this2;\n  }\n\n  return RequestError;\n}( /*#__PURE__*/_wrapNativeSuper(Error));\n/**\n * 响应异常\n */\n\nvar ResponseError = /*#__PURE__*/function (_Error2) {\n  _inherits(ResponseError, _Error2);\n\n  var _super2 = _createSuper(ResponseError);\n\n  function ResponseError(response, text, data, request) {\n    var _this3;\n\n    var type = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 'ResponseError';\n\n    _classCallCheck(this, ResponseError);\n\n    _this3 = _super2.call(this, text || response.statusText);\n    _this3.name = 'ResponseError';\n    _this3.data = data;\n    _this3.response = response;\n    _this3.request = request;\n    _this3.type = type;\n    return _this3;\n  }\n\n  return ResponseError;\n}( /*#__PURE__*/_wrapNativeSuper(Error));\n/**\n * http://gitlab.alipay-inc.com/KBSJ/gxt/blob/release_gxt_S8928905_20180531/src/util/request.js#L63\n * 支持gbk\n */\n\nfunction readerGBK(file) {\n  return new Promise(function (resolve, reject) {\n    var reader = new FileReader();\n\n    reader.onload = function () {\n      resolve(reader.result);\n    };\n\n    reader.onerror = reject;\n    reader.readAsText(file, 'GBK'); // setup GBK decoding\n  });\n}\n/**\n * 安全的JSON.parse\n */\n\nfunction safeJsonParse(data) {\n  var throwErrIfParseFail = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var response = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n  var request = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\n  try {\n    return JSON.parse(data);\n  } catch (e) {\n    if (throwErrIfParseFail) {\n      throw new ResponseError(response, 'JSON.parse fail', data, request, 'ParseError');\n    }\n  } // eslint-disable-line no-empty\n\n\n  return data;\n}\nfunction timeout2Throw(msec, timeoutMessage, request) {\n  return new Promise(function (_, reject) {\n    setTimeout(function () {\n      reject(new RequestError(timeoutMessage || \"timeout of \".concat(msec, \"ms exceeded\"), request, 'Timeout'));\n    }, msec);\n  });\n} // If request options contain 'cancelToken', reject request when token has been canceled\n\nfunction cancel2Throw(opt) {\n  return new Promise(function (_, reject) {\n    if (opt.cancelToken) {\n      opt.cancelToken.promise.then(function (cancel) {\n        reject(cancel);\n      });\n    }\n  });\n}\nvar toString = Object.prototype.toString; // Check env is browser or node\n\nfunction getEnv() {\n  var env; // Only Node.JS has a process variable that is of [[Class]] process\n\n  if (typeof process !== 'undefined' && toString.call(process) === '[object process]') {\n    // For node use HTTP adapter\n    env = 'NODE';\n  }\n\n  if (typeof XMLHttpRequest !== 'undefined') {\n    env = 'BROWSER';\n  }\n\n  return env;\n}\nfunction isArray(val) {\n  return _typeof(val) === 'object' && Object.prototype.toString.call(val) === '[object Array]';\n}\nfunction isURLSearchParams(val) {\n  return typeof URLSearchParams !== 'undefined' && val instanceof URLSearchParams;\n}\nfunction isDate(val) {\n  return _typeof(val) === 'object' && Object.prototype.toString.call(val) === '[object Date]';\n}\nfunction isObject(val) {\n  return val !== null && _typeof(val) === 'object';\n}\nfunction forEach2ObjArr(target, callback) {\n  if (!target) return;\n\n  if (_typeof(target) !== 'object') {\n    target = [target];\n  }\n\n  if (isArray(target)) {\n    for (var i = 0; i < target.length; i++) {\n      callback.call(null, target[i], i, target);\n    }\n  } else {\n    for (var key in target) {\n      if (Object.prototype.hasOwnProperty.call(target, key)) {\n        callback.call(null, target[key], key, target);\n      }\n    }\n  }\n}\nfunction getParamObject(val) {\n  if (isURLSearchParams(val)) {\n    return parse(val.toString(), {\n      strictNullHandling: true\n    });\n  }\n\n  if (typeof val === 'string') {\n    return [val];\n  }\n\n  return val;\n}\nfunction reqStringify(val) {\n  return stringify(val, {\n    arrayFormat: 'repeat',\n    strictNullHandling: true\n  });\n}\nfunction mergeRequestOptions(options, options2Merge) {\n  return _objectSpread2(_objectSpread2(_objectSpread2({}, options), options2Merge), {}, {\n    headers: _objectSpread2(_objectSpread2({}, options.headers), options2Merge.headers),\n    params: _objectSpread2(_objectSpread2({}, getParamObject(options.params)), getParamObject(options2Merge.params)),\n    method: (options2Merge.method || options.method || 'get').toLowerCase()\n  });\n}\n\n// 前后缀拦截\nvar addfix = function addfix(url) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var prefix = options.prefix,\n      suffix = options.suffix;\n\n  if (prefix) {\n    url = \"\".concat(prefix).concat(url);\n  }\n\n  if (suffix) {\n    url = \"\".concat(url).concat(suffix);\n  }\n\n  return {\n    url: url,\n    options: options\n  };\n};\n\nvar warnedCoreType = false; // 默认缓存判断，开放缓存判断给非 get 请求使用\n\nfunction __defaultValidateCache(url, options) {\n  var _options$method = options.method,\n      method = _options$method === void 0 ? 'get' : _options$method;\n  return method.toLowerCase() === 'get';\n}\n\nfunction fetchMiddleware(ctx, next) {\n  if (!ctx) return next();\n  var _ctx$req = ctx.req;\n  _ctx$req = _ctx$req === void 0 ? {} : _ctx$req;\n  var _ctx$req$options = _ctx$req.options,\n      options = _ctx$req$options === void 0 ? {} : _ctx$req$options,\n      _ctx$req$url = _ctx$req.url,\n      url = _ctx$req$url === void 0 ? '' : _ctx$req$url,\n      cache = ctx.cache,\n      responseInterceptors = ctx.responseInterceptors;\n\n  var _options$timeout = options.timeout,\n      timeout = _options$timeout === void 0 ? 0 : _options$timeout,\n      timeoutMessage = options.timeoutMessage,\n      _options$__umiRequest = options.__umiRequestCoreType__,\n      __umiRequestCoreType__ = _options$__umiRequest === void 0 ? 'normal' : _options$__umiRequest,\n      _options$useCache = options.useCache,\n      useCache = _options$useCache === void 0 ? false : _options$useCache,\n      _options$method2 = options.method,\n      method = _options$method2 === void 0 ? 'get' : _options$method2,\n      params = options.params,\n      ttl = options.ttl,\n      _options$validateCach = options.validateCache,\n      validateCache = _options$validateCach === void 0 ? __defaultValidateCache : _options$validateCach;\n\n  if (__umiRequestCoreType__ !== 'normal') {\n    if (process && process.env && process.env.NODE_ENV === 'development' && warnedCoreType === false) {\n      warnedCoreType = true;\n      console.warn('__umiRequestCoreType__ is a internal property that use in umi-request, change its value would affect the behavior of request! It only use when you want to extend or use request core.');\n    }\n\n    return next();\n  }\n\n  var adapter = fetch;\n\n  if (!adapter) {\n    throw new Error('Global fetch not exist!');\n  } // 从缓存池检查是否有缓存数据\n\n\n  var isBrowser = getEnv() === 'BROWSER';\n  var needCache = validateCache(url, options) && useCache && isBrowser;\n\n  if (needCache) {\n    var responseCache = cache.get({\n      url: url,\n      params: params,\n      method: method\n    });\n\n    if (responseCache) {\n      responseCache = responseCache.clone();\n      responseCache.useCache = true;\n      ctx.res = responseCache;\n      return next();\n    }\n  }\n\n  var response; // 超时处理、取消请求处理\n\n  if (timeout > 0) {\n    response = Promise.race([cancel2Throw(options), adapter(url, options), timeout2Throw(timeout, timeoutMessage, ctx.req)]);\n  } else {\n    response = Promise.race([cancel2Throw(options), adapter(url, options)]);\n  } // 兼容老版本 response.interceptor\n\n\n  responseInterceptors.forEach(function (handler) {\n    response = response.then(function (res) {\n      // Fix multiple clones not working, issue: https://github.com/github/fetch/issues/504\n      var clonedRes = typeof res.clone === 'function' ? res.clone() : res;\n      return handler(clonedRes, options);\n    });\n  });\n  return response.then(function (res) {\n    // 是否存入缓存池\n    if (needCache) {\n      if (res.status === 200) {\n        var copy = res.clone();\n        copy.useCache = true;\n        cache.set({\n          url: url,\n          params: params,\n          method: method\n        }, copy, ttl);\n      }\n    }\n\n    ctx.res = res;\n    return next();\n  });\n}\n\nfunction parseResponseMiddleware(ctx, next) {\n  var copy;\n  return next().then(function () {\n    if (!ctx) return;\n    var _ctx$res = ctx.res,\n        res = _ctx$res === void 0 ? {} : _ctx$res,\n        _ctx$req = ctx.req,\n        req = _ctx$req === void 0 ? {} : _ctx$req;\n\n    var _ref = req || {},\n        _ref$options = _ref.options;\n\n    _ref$options = _ref$options === void 0 ? {} : _ref$options;\n    var _ref$options$response = _ref$options.responseType,\n        responseType = _ref$options$response === void 0 ? 'json' : _ref$options$response,\n        _ref$options$charset = _ref$options.charset,\n        charset = _ref$options$charset === void 0 ? 'utf8' : _ref$options$charset,\n        _ref$options$getRespo = _ref$options.getResponse,\n        _ref$options$throwErr = _ref$options.throwErrIfParseFail,\n        throwErrIfParseFail = _ref$options$throwErr === void 0 ? false : _ref$options$throwErr,\n        _ref$options$parseRes = _ref$options.parseResponse,\n        parseResponse = _ref$options$parseRes === void 0 ? true : _ref$options$parseRes;\n\n    if (!parseResponse) {\n      return;\n    }\n\n    if (!res || !res.clone) {\n      return;\n    } // 只在浏览器环境对 response 做克隆， node 环境如果对 response 克隆会有问题：https://github.com/bitinn/node-fetch/issues/553\n\n\n    copy = getEnv() === 'BROWSER' ? res.clone() : res;\n    copy.useCache = res.useCache || false; // 解析数据\n\n    if (charset === 'gbk') {\n      try {\n        return res.blob().then(readerGBK).then(function (d) {\n          return safeJsonParse(d, false, copy, req);\n        });\n      } catch (e) {\n        throw new ResponseError(copy, e.message, null, req, 'ParseError');\n      }\n    } else if (responseType === 'json') {\n      return res.text().then(function (d) {\n        return safeJsonParse(d, throwErrIfParseFail, copy, req);\n      });\n    }\n\n    try {\n      // 其他如text, blob, arrayBuffer, formData\n      return res[responseType]();\n    } catch (e) {\n      throw new ResponseError(copy, 'responseType not support', null, req, 'ParseError');\n    }\n  }).then(function (body) {\n    if (!ctx) return;\n    var _ctx$res2 = ctx.res,\n        _ctx$req2 = ctx.req,\n        req = _ctx$req2 === void 0 ? {} : _ctx$req2;\n\n    var _ref2 = req || {},\n        _ref2$options = _ref2.options;\n\n    _ref2$options = _ref2$options === void 0 ? {} : _ref2$options;\n    var _ref2$options$getResp = _ref2$options.getResponse,\n        getResponse = _ref2$options$getResp === void 0 ? false : _ref2$options$getResp;\n\n    if (!copy) {\n      return;\n    }\n\n    if (copy.status >= 200 && copy.status < 300) {\n      // 提供源response, 以便自定义处理\n      if (getResponse) {\n        ctx.res = {\n          data: body,\n          response: copy\n        };\n        return;\n      }\n\n      ctx.res = body;\n      return;\n    }\n\n    throw new ResponseError(copy, 'http error', body, req, 'HttpError');\n  }).catch(function (e) {\n    if (e instanceof RequestError || e instanceof ResponseError) {\n      throw e;\n    } // 对未知错误进行处理\n\n\n    var req = ctx.req,\n        res = ctx.res;\n    e.request = e.request || req;\n    e.response = e.response || res;\n    e.type = e.type || e.name;\n    e.data = e.data || undefined;\n    throw e;\n  });\n}\n\nfunction simplePostMiddleware(ctx, next) {\n  if (!ctx) return next();\n  var _ctx$req = ctx.req;\n  _ctx$req = _ctx$req === void 0 ? {} : _ctx$req;\n  var _ctx$req$options = _ctx$req.options,\n      options = _ctx$req$options === void 0 ? {} : _ctx$req$options;\n  var _options$method = options.method,\n      method = _options$method === void 0 ? 'get' : _options$method;\n\n  if (['post', 'put', 'patch', 'delete'].indexOf(method.toLowerCase()) === -1) {\n    return next();\n  }\n\n  var _options$requestType = options.requestType,\n      requestType = _options$requestType === void 0 ? 'json' : _options$requestType,\n      data = options.data; // 数据使用类axios的新字段data, 避免引用后影响旧代码, 如将body stringify多次\n\n  if (data) {\n    var dataType = Object.prototype.toString.call(data);\n\n    if (dataType === '[object Object]' || dataType === '[object Array]') {\n      if (requestType === 'json') {\n        options.headers = _objectSpread2({\n          Accept: 'application/json',\n          'Content-Type': 'application/json;charset=UTF-8'\n        }, options.headers);\n        options.body = JSON.stringify(data);\n      } else if (requestType === 'form') {\n        options.headers = _objectSpread2({\n          Accept: 'application/json',\n          'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8'\n        }, options.headers);\n        options.body = reqStringify(data);\n      }\n    } else {\n      // 其他 requestType 自定义header\n      options.headers = _objectSpread2({\n        Accept: 'application/json'\n      }, options.headers);\n      options.body = data;\n    }\n  }\n\n  ctx.req.options = options;\n  return next();\n}\n\nfunction paramsSerialize(params, paramsSerializer) {\n  var serializedParams;\n  var jsonStringifiedParams; // 支持参数自动拼装，其他 method 也可用，不冲突\n\n  if (params) {\n    if (paramsSerializer) {\n      serializedParams = paramsSerializer(params);\n    } else if (isURLSearchParams(params)) {\n      serializedParams = params.toString();\n    } else {\n      if (isArray(params)) {\n        jsonStringifiedParams = [];\n        forEach2ObjArr(params, function (item) {\n          if (item === null || typeof item === 'undefined') {\n            jsonStringifiedParams.push(item);\n          } else {\n            jsonStringifiedParams.push(isObject(item) ? JSON.stringify(item) : item);\n          }\n        }); // a: [1,2,3] => a=1&a=2&a=3\n\n        serializedParams = reqStringify(jsonStringifiedParams);\n      } else {\n        jsonStringifiedParams = {};\n        forEach2ObjArr(params, function (value, key) {\n          var jsonStringifiedValue = value;\n\n          if (value === null || typeof value === 'undefined') {\n            jsonStringifiedParams[key] = value;\n          } else if (isDate(value)) {\n            jsonStringifiedValue = value.toISOString();\n          } else if (isArray(value)) {\n            jsonStringifiedValue = value;\n          } else if (isObject(value)) {\n            jsonStringifiedValue = JSON.stringify(value);\n          }\n\n          jsonStringifiedParams[key] = jsonStringifiedValue;\n        });\n        var tmp = reqStringify(jsonStringifiedParams);\n        serializedParams = tmp;\n      }\n    }\n  }\n\n  return serializedParams;\n} // 对请求参数做处理，实现 query 简化、 post 简化\n\nfunction simpleGetMiddleware(ctx, next) {\n  if (!ctx) return next();\n  var _ctx$req = ctx.req;\n  _ctx$req = _ctx$req === void 0 ? {} : _ctx$req;\n  var _ctx$req$options = _ctx$req.options,\n      options = _ctx$req$options === void 0 ? {} : _ctx$req$options;\n  var paramsSerializer = options.paramsSerializer,\n      params = options.params;\n  var _ctx$req2 = ctx.req;\n  _ctx$req2 = _ctx$req2 === void 0 ? {} : _ctx$req2;\n  var _ctx$req2$url = _ctx$req2.url,\n      url = _ctx$req2$url === void 0 ? '' : _ctx$req2$url; // 将 method 改为大写\n\n  options.method = options.method ? options.method.toUpperCase() : 'GET'; // 设置 credentials 默认值为 same-origin，确保当开发者没有设置时，各浏览器对请求是否发送 cookies 保持一致的行为\n  // - omit: 从不发送cookies.\n  // - same-origin: 只有当URL与响应脚本同源才发送 cookies、 HTTP Basic authentication 等验证信息.(浏览器默认值,在旧版本浏览器，例如safari 11依旧是omit，safari 12已更改)\n  // - include: 不论是不是跨域的请求,总是发送请求资源域在本地的 cookies、 HTTP Basic authentication 等验证信息.\n\n  options.credentials = options.credentials || 'same-origin'; // 支持类似axios 参数自动拼装, 其他method也可用, 不冲突.\n\n  var serializedParams = paramsSerialize(params, paramsSerializer);\n  ctx.req.originUrl = url;\n\n  if (serializedParams) {\n    var urlSign = url.indexOf('?') !== -1 ? '&' : '?';\n    ctx.req.url = \"\".concat(url).concat(urlSign).concat(serializedParams);\n  }\n\n  ctx.req.options = options;\n  return next();\n}\n\nvar globalMiddlewares = [simplePostMiddleware, simpleGetMiddleware, parseResponseMiddleware];\nvar coreMiddlewares = [fetchMiddleware];\nOnion.globalMiddlewares = globalMiddlewares;\nOnion.defaultGlobalMiddlewaresLength = globalMiddlewares.length;\nOnion.coreMiddlewares = coreMiddlewares;\nOnion.defaultCoreMiddlewaresLength = coreMiddlewares.length;\n\nvar Core = /*#__PURE__*/function () {\n  function Core(initOptions) {\n    _classCallCheck(this, Core);\n\n    this.onion = new Onion([]);\n    this.fetchIndex = 0; // 【即将废弃】请求中间件位置\n\n    this.mapCache = new MapCache(initOptions);\n    this.initOptions = initOptions;\n    this.instanceRequestInterceptors = [];\n    this.instanceResponseInterceptors = [];\n  } // 旧版拦截器为共享\n\n\n  _createClass(Core, [{\n    key: \"use\",\n    value: function use(newMiddleware) {\n      var opt = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n        global: false,\n        core: false\n      };\n      this.onion.use(newMiddleware, opt);\n      return this;\n    }\n  }, {\n    key: \"extendOptions\",\n    value: function extendOptions(options) {\n      this.initOptions = mergeRequestOptions(this.initOptions, options);\n      this.mapCache.extendOptions(options);\n    } // 执行请求前拦截器\n\n  }, {\n    key: \"dealRequestInterceptors\",\n    value: function dealRequestInterceptors(ctx) {\n      var reducer = function reducer(p1, p2) {\n        return p1.then(function () {\n          var ret = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n          ctx.req.url = ret.url || ctx.req.url;\n          ctx.req.options = ret.options || ctx.req.options;\n          return p2(ctx.req.url, ctx.req.options);\n        });\n      };\n\n      var allInterceptors = [].concat(_toConsumableArray(Core.requestInterceptors), _toConsumableArray(this.instanceRequestInterceptors));\n      return allInterceptors.reduce(reducer, Promise.resolve()).then(function () {\n        var ret = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        ctx.req.url = ret.url || ctx.req.url;\n        ctx.req.options = ret.options || ctx.req.options;\n        return Promise.resolve();\n      });\n    }\n  }, {\n    key: \"request\",\n    value: function request(url, options) {\n      var _this = this;\n\n      var onion = this.onion;\n      var obj = {\n        req: {\n          url: url,\n          options: _objectSpread2(_objectSpread2({}, options), {}, {\n            url: url\n          })\n        },\n        res: null,\n        cache: this.mapCache,\n        responseInterceptors: [].concat(_toConsumableArray(Core.responseInterceptors), _toConsumableArray(this.instanceResponseInterceptors))\n      };\n\n      if (typeof url !== 'string') {\n        throw new Error('url MUST be a string');\n      }\n\n      return new Promise(function (resolve, reject) {\n        _this.dealRequestInterceptors(obj).then(function () {\n          return onion.execute(obj);\n        }).then(function () {\n          resolve(obj.res);\n        }).catch(function (error) {\n          var errorHandler = obj.req.options.errorHandler;\n\n          if (errorHandler) {\n            try {\n              var data = errorHandler(error);\n              resolve(data);\n            } catch (e) {\n              reject(e);\n            }\n          } else {\n            reject(error);\n          }\n        });\n      });\n    }\n  }], [{\n    key: \"requestUse\",\n    value: // 请求拦截器 默认 { global: true } 兼容旧版本拦截器\n    function requestUse(handler) {\n      var opt = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n        global: true\n      };\n      if (typeof handler !== 'function') throw new TypeError('Interceptor must be function!');\n\n      if (opt.global) {\n        Core.requestInterceptors.push(handler);\n      } else {\n        this.instanceRequestInterceptors.push(handler);\n      }\n    } // 响应拦截器 默认 { global: true } 兼容旧版本拦截器\n\n  }, {\n    key: \"responseUse\",\n    value: function responseUse(handler) {\n      var opt = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n        global: true\n      };\n      if (typeof handler !== 'function') throw new TypeError('Interceptor must be function!');\n\n      if (opt.global) {\n        Core.responseInterceptors.push(handler);\n      } else {\n        this.instanceResponseInterceptors.push(handler);\n      }\n    }\n  }]);\n\n  return Core;\n}();\n\nCore.requestInterceptors = [addfix];\nCore.responseInterceptors = [];\n\n/**\n * 当执行 “取消请求” 操作时会抛出 Cancel 对象作为一场\n * @class\n * @param {string=} message The message.\n */\n\nfunction Cancel(message) {\n  this.message = message;\n}\n\nCancel.prototype.toString = function toString() {\n  return this.message ? \"Cancel: \".concat(this.message) : 'Cancel';\n};\n\nCancel.prototype.__CANCEL__ = true;\n\n/**\n * 通过 CancelToken 来取消请求操作\n *\n * @class\n * @param {Function} executor The executor function.\n */\n\nfunction CancelToken(executor) {\n  if (typeof executor !== 'function') {\n    throw new TypeError('executor must be a function.');\n  }\n\n  var resolvePromise;\n  this.promise = new Promise(function promiseExecutor(resolve) {\n    resolvePromise = resolve;\n  });\n  var token = this;\n  executor(function cancel(message) {\n    if (token.reason) {\n      // 取消操作已被调用过\n      return;\n    }\n\n    token.reason = new Cancel(message);\n    resolvePromise(token.reason);\n  });\n}\n/**\n * 如果请求已经取消，抛出 Cancel 异常\n */\n\n\nCancelToken.prototype.throwIfRequested = function throwIfRequested() {\n  if (this.reason) {\n    throw this.reason;\n  }\n};\n/**\n * 通过 source 来返回 CancelToken 实例和取消 CancelToken 的函数\n */\n\n\nCancelToken.source = function source() {\n  var cancel;\n  var token = new CancelToken(function executor(c) {\n    cancel = c;\n  });\n  return {\n    token: token,\n    cancel: cancel\n  };\n};\n\nfunction isCancel(value) {\n  return !!(value && value.__CANCEL__);\n}\n\nvar request = function request() {\n  var initOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var coreInstance = new Core(initOptions);\n\n  var umiInstance = function umiInstance(url) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var mergeOptions = mergeRequestOptions(coreInstance.initOptions, options);\n    return coreInstance.request(url, mergeOptions);\n  }; // 中间件\n\n\n  umiInstance.use = coreInstance.use.bind(coreInstance);\n  umiInstance.fetchIndex = coreInstance.fetchIndex; // 拦截器\n\n  umiInstance.interceptors = {\n    request: {\n      use: Core.requestUse.bind(coreInstance)\n    },\n    response: {\n      use: Core.responseUse.bind(coreInstance)\n    }\n  }; // 请求语法糖： reguest.get request.post ……\n\n  var METHODS = ['get', 'post', 'delete', 'put', 'patch', 'head', 'options', 'rpc'];\n  METHODS.forEach(function (method) {\n    umiInstance[method] = function (url, options) {\n      return umiInstance(url, _objectSpread2(_objectSpread2({}, options), {}, {\n        method: method\n      }));\n    };\n  });\n  umiInstance.Cancel = Cancel;\n  umiInstance.CancelToken = CancelToken;\n  umiInstance.isCancel = isCancel;\n  umiInstance.extendOptions = coreInstance.extendOptions.bind(coreInstance); // 暴露各个实例的中间件，供开发者自由组合\n\n  umiInstance.middlewares = {\n    instance: coreInstance.onion.middlewares,\n    defaultInstance: coreInstance.onion.defaultMiddlewares,\n    global: Onion.globalMiddlewares,\n    core: Onion.coreMiddlewares\n  };\n  return umiInstance;\n};\n/**\n * extend 方法参考了ky, 让用户可以定制配置.\n * initOpions 初始化参数\n * @param {number} maxCache 最大缓存数\n * @param {string} prefix url前缀\n * @param {function} errorHandler 统一错误处理方法\n * @param {object} headers 统一的headers\n */\n\n\nvar extend = function extend(initOptions) {\n  return request(initOptions);\n};\n/**\n * 暴露 fetch 中间件，保障依旧可以使用\n */\n\nvar fetch$1 = request({\n  parseResponse: false\n});\nvar request$1 = request({});\n\nexport default request$1;\nexport { Onion, RequestError, ResponseError, extend, fetch$1 as fetch };\n"]},"metadata":{},"sourceType":"module"}